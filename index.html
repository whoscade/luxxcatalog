<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>LUXXCATALOG</title>
<style>
@font-face { font-family:'Experimento'; src:url('fonts/Experimento.ttf') format('truetype'); }
@font-face { font-family:'GadetyperRegular'; src:url('fonts/GadetyperRegular.otf') format('opentype'); }
@font-face { font-family:'timesnewarial'; src:url('fonts/timesnewarial.ttf') format('truetype'); }

html, body {
  margin:0;
  padding:0;
  height:100%;
  overflow:hidden;
  background:#ff0000;
  font-family:monospace;
  display:flex;
  justify-content:center;
  align-items:center;
}

#logo {
  font-size:clamp(2.5rem,12vw,8rem);
  line-height:1;
  white-space:nowrap;
  display:flex;
}

.letter { display:inline-block; }

#scrollMenu {
  position:fixed;
  bottom:0;
  left:0;
  width:100%;
  height:50vh;
  background:linear-gradient(to bottom, #000 0%, #111 100%);
  box-shadow: inset 0 4px 12px #000, 0 4px 12px rgba(0,0,0,0.6);
  transform:translateY(100%);
  transition:transform 0.3s ease;
  z-index:1000;
  pointer-events:none;
  display:flex;
  flex-direction:column;
  padding:20px;
  box-sizing:border-box;
  border-radius:4px;
}

#scrollMenu.active { transform:translateY(0); pointer-events:auto; }

#menuBar {
  height:12%;
  display:flex;
  align-items:center;
  justify-content:flex-start;
  color:white;
  font-family:monospace;
  font-size:1.1rem;
  gap:25px;
  border-bottom:1px solid #181818;
  padding-bottom:8px;
  padding-left:12px;
}

#menuBar div {
  cursor:pointer;
  position:relative;
  text-transform:uppercase;
}

#menuBar div::after {
  content:'';
  position:absolute;
  width:0%;
  height:2px;
  bottom:-2px;
  left:0;
  background:#ff0000;
  transition:width 0.2s ease;
}

#menuBar div:hover::after { width:100%; }

#synthArea {
  flex:1;
  display:flex;
  justify-content:flex-start;
  align-items:flex-start;
  gap:20px;
  padding-top:45px;
}

#pads {
  display:flex;
  flex-direction:column;
  gap:16px;
  flex-shrink:0;
}

.padRow { display:flex; gap:16px; }

.pad {
  width:min(22vw,100px);
  height:min(22vw,100px);
  background:#181818 url('imgs/button.jpg') center/cover no-repeat;
  border-radius:6px;
  display:flex;
  justify-content:center;
  align-items:center;
  cursor:pointer;
  position:relative;
  transition:0.1s;
}

.pad:hover { box-shadow:0 0 6px #ff0000 inset; }

.pad.active {
  box-shadow:0 0 6px #ff0000,0 0 12px #ff0000 inset;
}

.pad span {
  position:absolute;
  top:6px;
  right:6px;
  width:12px;
  height:12px;
  border-radius:50%;
  background:#600;
  box-shadow:0 0 4px #600;
}

.pad.active span {
  background:#ff0000;
  box-shadow:0 0 12px #ff0000;
}

#divider {
  width:2px;
  background:#181818;
  margin:0 20px;
}

#waveCanvas {
  width:180px;
  height:80px;
  margin-left:-5px;
  margin-top:0px;
  background:#181818;
  border-radius:6px;
  align-self:flex-start;
  box-shadow: inset 0 4px 12px #000;
}

#waveSelector {
  display:flex;
  flex-direction:row;
  align-items:center;
  justify-content:center;
  margin-left:-200px;
  margin-top:90px;
  gap:10px;
}

.waveButton {
  width:28px;
  height:28px;
  background:#181818;
  border-radius:4px;
  display:flex;
  align-items:center;
  justify-content:center;
  cursor:pointer;
  color:white;
  user-select:none;
  font-family:monospace;
  font-weight:normal;
  transition:0.15s;
}

.waveButton:hover {
  box-shadow:0 0 6px #ff0000 inset, 0 0 12px #ff0000;
  color:#ff3333;
}
</style>
</head>
<body>
<div id="logo"></div>
<div id="scrollMenu">
  <div id="menuBar">
    <div>ARCHIVE</div>
    <div>MAILING LIST</div>
  </div>
  <div id="synthArea">
    <div id="pads">
      <div class="padRow" id="padRowTop"></div>
      <div class="padRow" id="padRowBottom"></div>
    </div>
    <canvas id="waveCanvas" width="180" height="80"></canvas>
    <div id="waveSelector">
      <div class="waveButton" id="prevWave">&#9664;</div>
      <div class="waveButton" id="nextWave">&#9654;</div>
    </div>
    <div id="divider"></div>
  </div>
</div>
<script>
const logoText="LUXXCATALOG";
const logo=document.getElementById('logo');
const fonts=['Experimento','GadetyperRegular','timesnewarial'];
function randomizeLogo(){
  logo.innerHTML='';
  for(let char of logoText){
    const span=document.createElement('span');
    span.classList.add('letter');
    span.textContent=char;
    span.style.fontFamily=fonts[Math.floor(Math.random()*fonts.length)];
    logo.appendChild(span);
  }
}
randomizeLogo();
setInterval(randomizeLogo,117);

const menu=document.getElementById('scrollMenu');
window.addEventListener('wheel', e=>{
  if(e.deltaY>0) menu.classList.add('active');
  else if(e.deltaY<0) menu.classList.remove('active');
});

let touchStartY=0, touchEndY=0;
window.addEventListener('touchstart', e=>{touchStartY=e.changedTouches[0].screenY;}, false);
window.addEventListener('touchend', e=>{
  touchEndY=e.changedTouches[0].screenY;
  const diff=touchStartY-touchEndY;
  if(diff>50) menu.classList.add('active');
  else if(diff<-50) menu.classList.remove('active');
}, false);

const audioCtx=new (window.AudioContext||window.webkitAudioContext)();
let attack=0.1, release=0.25;
let currentWave='sine';
const waveTypes=['sine','triangle','sawtooth','square'];

const padRows=[document.getElementById('padRowTop'),document.getElementById('padRowBottom')];
const padData=new Map();
const canvas=document.getElementById('waveCanvas');
const ctx=canvas.getContext('2d');
const analyser=audioCtx.createAnalyser();
analyser.fftSize=1024;
const bufferLength=analyser.fftSize;
const dataArray=new Float32Array(bufferLength);
let displayedWave=new Float32Array(bufferLength);

function getWavePoints(type){
  const w=canvas.width;
  const h=canvas.height;
  const points=new Float32Array(w);
  for(let i=0;i<w;i++){
    const x=i/w*2*Math.PI;
    let y=h/2;
    if(type==='sine') y=h/2 + Math.sin(x)*h/2*0.8;
    else if(type==='triangle') y=h/2 + (2/Math.PI)*Math.asin(Math.sin(x))*h/2*0.8;
    else if(type==='square') y=h/2 + Math.sign(Math.sin(x))*h/2*0.8;
    else if(type==='sawtooth') y=h/2 + (2*(x/2/Math.PI - Math.floor(0.5 + x/2/Math.PI)))*h/2*0.8;
    points[i] = y;
  }
  return points;
}

displayedWave = getWavePoints(currentWave);

function drawWave(){
  requestAnimationFrame(drawWave);
  ctx.fillStyle='#181818';
  ctx.fillRect(0,0,canvas.width,canvas.height);
  ctx.lineWidth=2;
  ctx.strokeStyle = padData.size > 0 ? '#ff0000' : '#600';
  ctx.beginPath();
  let targetWave;
  if(padData.size>0){
    analyser.getFloatTimeDomainData(dataArray);
    targetWave = new Float32Array(canvas.width);
    for(let i=0;i<canvas.width;i++){
      const idx=Math.floor(i*bufferLength/canvas.width);
      targetWave[i] = canvas.height/2 + dataArray[idx]*0.8*canvas.height/2;
      displayedWave[i] += (targetWave[i] - displayedWave[i])*0.15;
    }
  } else {
    targetWave = getWavePoints(currentWave);
    for(let i=0;i<canvas.width;i++){
      displayedWave[i] += (targetWave[i] - displayedWave[i])*0.15;
    }
  }
  for(let i=0;i<canvas.width;i++){
    const x=i;
    const y=displayedWave[i];
    if(i===0) ctx.moveTo(x,y); else ctx.lineTo(x,y);
  }
  ctx.stroke();
}
drawWave();

for(let i=0;i<12;i++){
  const pad=document.createElement('div');
  pad.classList.add('pad');
  const led=document.createElement('span');
  pad.appendChild(led);
  const row=i<6?padRows[0]:padRows[1];
  row.appendChild(pad);

  function playPad(){
    if(pad.classList.contains('active')){
      const data=padData.get(pad);
      if(data){
        const {osc,gainNode}=data;
        const now=audioCtx.currentTime;
        gainNode.gain.cancelScheduledValues(now);
        gainNode.gain.setValueAtTime(gainNode.gain.value,now);
        gainNode.gain.linearRampToValueAtTime(0,now+release);
        osc.stop(now+release+0.05);
        setTimeout(()=>padData.delete(pad),(release*1000)+100);
      }
      pad.classList.remove('active');
    } else {
      pad.classList.add('active');
      const osc=audioCtx.createOscillator();
      const gainNode=audioCtx.createGain();
      const now=audioCtx.currentTime;
      osc.type=currentWave;
      osc.frequency.setValueAtTime(110*Math.pow(2,i/12),now);
      gainNode.gain.setValueAtTime(0,now);
      gainNode.gain.linearRampToValueAtTime(1,now+attack);
      osc.connect(gainNode).connect(analyser).connect(audioCtx.destination);
      osc.start();
      padData.set(pad,{osc,gainNode});
    }
  }
  pad.addEventListener('click',playPad);
  pad.addEventListener('touchstart',e=>{e.preventDefault();playPad();});
}

function updateActiveWaveforms() {
  padData.forEach(({osc}) => { try { osc.type=currentWave; } catch{} });
}

document.getElementById('prevWave').addEventListener('click',()=>{
  let index=waveTypes.indexOf(currentWave);
  index=(index-1+waveTypes.length)%waveTypes.length;
  currentWave=waveTypes[index];
  updateActiveWaveforms();
});
document.getElementById('nextWave').addEventListener('click',()=>{
  let index=waveTypes.indexOf(currentWave);
  index=(index+1)%waveTypes.length;
  currentWave=waveTypes[index];
  updateActiveWaveforms();
});
</script>
</body>
</html>
